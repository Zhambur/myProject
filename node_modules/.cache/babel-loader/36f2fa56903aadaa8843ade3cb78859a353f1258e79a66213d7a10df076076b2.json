{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nexport default {\n  name: \"Threat\",\n  data() {\n    return {\n      threatRelationChart: null,\n      evidenceChart: null,\n      selectedEvent: null,\n      threatEvents: [{\n        id: 1,\n        type: \"数据外发\",\n        date: \"2017-11-12\",\n        time: \"02:35:18\",\n        user: \"1103\",\n        description: \"非工作时间大量数据传输\",\n        detailDescription: \"员工1103在凌晨2:35分登录服务器，下载大量产品设计文件并发送至外部邮箱。期间共传输了约230MB数据，包含多个产品核心模块的设计文档和源代码片段。\",\n        level: \"高\"\n      }, {\n        id: 2,\n        type: \"账户探测\",\n        date: \"2017-11-13\",\n        time: \"20:14:56\",\n        user: \"1152\",\n        description: \"多次尝试登录他人账户\",\n        detailDescription: \"员工1152在11月13日晚间尝试登录15个不同研发人员的账户，成功登录3个，访问了代码仓库和设计文档。使用的IP地址在公司网络范围内但非其常用工作站。\",\n        level: \"中\"\n      }, {\n        id: 3,\n        type: \"异常行为\",\n        date: \"2017-11-15\",\n        time: \"23:45:07\",\n        user: \"1388\",\n        description: \"深夜办公异常活动\",\n        detailDescription: \"员工1388在11月15日23:45至次日凌晨3:20期间，在办公室进行工作，访问了大量与其工作职责无关的系统和文件。次日请假未到岗。这是连续第5天出现类似模式。\",\n        level: \"中\"\n      }, {\n        id: 4,\n        type: \"数据库异常\",\n        date: \"2017-11-10\",\n        time: \"15:23:41\",\n        user: \"1307\",\n        description: \"大量非常规数据库查询\",\n        detailDescription: \"员工1307在11月10日执行了超过200次数据库查询，涉及产品核心数据表的多个敏感字段。查询模式显示系统性的数据收集行为，远超正常工作所需。\",\n        level: \"高\"\n      }, {\n        id: 5,\n        type: \"可疑通信\",\n        date: \"2017-11-22\",\n        time: \"19:08:33\",\n        user: \"1204\",\n        description: \"与未知IP地址加密通信\",\n        detailDescription: \"员工1204的工作站在11月22日与5个未在公司白名单内的IP地址建立加密连接，总计传输数据约320MB。流量特征与数据泄露的典型模式高度匹配。\",\n        level: \"高\"\n      }]\n    };\n  },\n  mounted() {\n    this.initThreatRelationChart();\n    window.addEventListener(\"resize\", this.handleResize);\n  },\n  beforeDestroy() {\n    window.removeEventListener(\"resize\", this.handleResize);\n  },\n  methods: {\n    handleResize() {\n      this.threatRelationChart && this.threatRelationChart.resize();\n      this.evidenceChart && this.evidenceChart.resize();\n    },\n    initThreatRelationChart() {\n      this.threatRelationChart = this.$echarts.init(document.getElementById(\"threatRelationChart\"));\n      const option = {\n        title: {\n          text: \"威胁事件关联图\",\n          subtext: \"基于时间、人员和行为关联分析\",\n          left: \"center\"\n        },\n        tooltip: {\n          formatter: function (params) {\n            if (params.dataType === \"edge\") {\n              return params.data.name;\n            }\n            return params.data.name + \"<br/>ID: \" + params.data.id + \"<br/>日期: \" + params.data.date;\n          }\n        },\n        legend: [{\n          data: [\"数据外发\", \"账户探测\", \"异常行为\", \"数据库异常\", \"可疑通信\", \"涉事员工\"],\n          top: 30,\n          right: 10\n        }],\n        animationDurationUpdate: 1500,\n        animationEasingUpdate: \"quinticInOut\",\n        series: [{\n          name: \"威胁关联\",\n          type: \"graph\",\n          layout: \"force\",\n          force: {\n            repulsion: 300,\n            edgeLength: 120,\n            gravity: 0.1,\n            layoutAnimation: true\n          },\n          roam: true,\n          draggable: true,\n          focusNodeAdjacency: true,\n          label: {\n            show: true,\n            position: \"right\",\n            formatter: \"{b}\",\n            fontSize: 12,\n            fontWeight: \"bold\"\n          },\n          data: [{\n            name: \"非工作时间数据外发\",\n            category: 0,\n            id: 1,\n            date: \"2017-11-12\",\n            symbolSize: 50,\n            itemStyle: {\n              color: \"#F56C6C\"\n            }\n          }, {\n            name: \"多次尝试登录他人账户\",\n            category: 1,\n            id: 2,\n            date: \"2017-11-13\",\n            symbolSize: 45,\n            itemStyle: {\n              color: \"#E6A23C\"\n            }\n          }, {\n            name: \"深夜办公异常活动\",\n            category: 2,\n            id: 3,\n            date: \"2017-11-15\",\n            symbolSize: 45,\n            itemStyle: {\n              color: \"#E6A23C\"\n            }\n          }, {\n            name: \"大量非常规数据库查询\",\n            category: 3,\n            id: 4,\n            date: \"2017-11-10\",\n            symbolSize: 50,\n            itemStyle: {\n              color: \"#F56C6C\"\n            }\n          }, {\n            name: \"与未知IP加密通信\",\n            category: 4,\n            id: 5,\n            date: \"2017-11-22\",\n            symbolSize: 50,\n            itemStyle: {\n              color: \"#F56C6C\"\n            }\n          }, {\n            name: \"员工1103\",\n            category: 5,\n            symbolSize: 38,\n            itemStyle: {\n              color: \"#409EFF\"\n            }\n          }, {\n            name: \"员工1152\",\n            category: 5,\n            symbolSize: 38,\n            itemStyle: {\n              color: \"#409EFF\"\n            }\n          }, {\n            name: \"员工1388\",\n            category: 5,\n            symbolSize: 38,\n            itemStyle: {\n              color: \"#409EFF\"\n            }\n          }, {\n            name: \"员工1307\",\n            category: 5,\n            symbolSize: 38,\n            itemStyle: {\n              color: \"#409EFF\"\n            }\n          }, {\n            name: \"员工1204\",\n            category: 5,\n            symbolSize: 38,\n            itemStyle: {\n              color: \"#409EFF\"\n            }\n          }, {\n            name: \"外部邮箱\",\n            category: 5,\n            symbolSize: 30,\n            itemStyle: {\n              color: \"#67C23A\"\n            }\n          }, {\n            name: \"未知IP地址\",\n            category: 5,\n            symbolSize: 30,\n            itemStyle: {\n              color: \"#67C23A\"\n            }\n          }, {\n            name: \"产品代码仓库\",\n            category: 5,\n            symbolSize: 30,\n            itemStyle: {\n              color: \"#67C23A\"\n            }\n          }, {\n            name: \"产品数据库\",\n            category: 5,\n            symbolSize: 30,\n            itemStyle: {\n              color: \"#67C23A\"\n            }\n          }],\n          links: [{\n            source: \"员工1103\",\n            target: \"非工作时间数据外发\",\n            name: \"执行者\",\n            lineStyle: {\n              width: 3,\n              color: \"#F56C6C\"\n            }\n          }, {\n            source: \"员工1152\",\n            target: \"多次尝试登录他人账户\",\n            name: \"执行者\",\n            lineStyle: {\n              width: 3,\n              color: \"#E6A23C\"\n            }\n          }, {\n            source: \"员工1388\",\n            target: \"深夜办公异常活动\",\n            name: \"执行者\",\n            lineStyle: {\n              width: 3,\n              color: \"#E6A23C\"\n            }\n          }, {\n            source: \"员工1307\",\n            target: \"大量非常规数据库查询\",\n            name: \"执行者\",\n            lineStyle: {\n              width: 3,\n              color: \"#F56C6C\"\n            }\n          }, {\n            source: \"员工1204\",\n            target: \"与未知IP加密通信\",\n            name: \"执行者\",\n            lineStyle: {\n              width: 3,\n              color: \"#F56C6C\"\n            }\n          }, {\n            source: \"非工作时间数据外发\",\n            target: \"外部邮箱\",\n            name: \"数据传输\",\n            lineStyle: {\n              width: 3\n            }\n          }, {\n            source: \"非工作时间数据外发\",\n            target: \"产品代码仓库\",\n            name: \"数据来源\",\n            lineStyle: {\n              width: 2\n            }\n          }, {\n            source: \"多次尝试登录他人账户\",\n            target: \"产品代码仓库\",\n            name: \"访问目标\",\n            lineStyle: {\n              width: 2\n            }\n          }, {\n            source: \"大量非常规数据库查询\",\n            target: \"产品数据库\",\n            name: \"查询目标\",\n            lineStyle: {\n              width: 3\n            }\n          }, {\n            source: \"与未知IP加密通信\",\n            target: \"未知IP地址\",\n            name: \"通信目标\",\n            lineStyle: {\n              width: 3\n            }\n          }, {\n            source: \"员工1103\",\n            target: \"员工1204\",\n            name: \"频繁邮件往来\",\n            lineStyle: {\n              type: \"dashed\",\n              width: 2,\n              curveness: 0.2\n            }\n          }, {\n            source: \"员工1152\",\n            target: \"员工1388\",\n            name: \"同时间段活动\",\n            lineStyle: {\n              type: \"dashed\",\n              width: 2,\n              curveness: 0.2\n            }\n          }, {\n            source: \"员工1307\",\n            target: \"员工1103\",\n            name: \"活动时间关联\",\n            lineStyle: {\n              type: \"dashed\",\n              width: 2,\n              curveness: 0.2\n            }\n          }, {\n            source: \"大量非常规数据库查询\",\n            target: \"非工作时间数据外发\",\n            name: \"时间顺序关联\",\n            lineStyle: {\n              type: \"dashed\",\n              width: 2,\n              curveness: 0.2\n            }\n          }, {\n            source: \"多次尝试登录他人账户\",\n            target: \"深夜办公异常活动\",\n            name: \"时间顺序关联\",\n            lineStyle: {\n              type: \"dashed\",\n              width: 2,\n              curveness: 0.2\n            }\n          }, {\n            source: \"与未知IP加密通信\",\n            target: \"外部邮箱\",\n            name: \"可能的同一接收方\",\n            lineStyle: {\n              type: \"dashed\",\n              width: 2,\n              curveness: 0.2\n            }\n          }],\n          categories: [{\n            name: \"数据外发\"\n          }, {\n            name: \"账户探测\"\n          }, {\n            name: \"异常行为\"\n          }, {\n            name: \"数据库异常\"\n          }, {\n            name: \"可疑通信\"\n          }, {\n            name: \"涉事员工\"\n          }],\n          lineStyle: {\n            opacity: 0.9,\n            width: 2,\n            curveness: 0\n          },\n          emphasis: {\n            focus: \"adjacency\",\n            lineStyle: {\n              width: 6\n            },\n            itemStyle: {\n              shadowBlur: 10,\n              shadowColor: \"rgba(0,0,0,0.5)\"\n            }\n          }\n        }]\n      };\n      this.threatRelationChart.setOption(option);\n\n      // 点击事件处理\n      this.threatRelationChart.on(\"click\", params => {\n        if (params.dataType === \"node\" && params.data.id) {\n          // 查找并选择对应的威胁事件\n          const event = this.threatEvents.find(item => item.id === params.data.id);\n          if (event) {\n            this.handleEventSelect(event);\n          }\n        }\n      });\n    },\n    handleEventSelect(row) {\n      this.selectedEvent = row;\n      this.$nextTick(() => {\n        this.initEvidenceChart();\n      });\n    },\n    initEvidenceChart() {\n      if (!this.selectedEvent) return;\n      this.evidenceChart = this.$echarts.init(document.getElementById(\"evidenceChart\"));\n\n      // 根据不同事件类型显示不同的证据图表\n      let option = {};\n      if (this.selectedEvent.type === \"数据外发\" || this.selectedEvent.type === \"可疑通信\") {\n        // 数据传输时间线\n        const hours = [\"00:00\", \"02:00\", \"04:00\", \"06:00\", \"08:00\", \"10:00\", \"12:00\", \"14:00\", \"16:00\", \"18:00\", \"20:00\", \"22:00\", \"24:00\"];\n        const data = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\n        // 根据事件类型设置数据\n        if (this.selectedEvent.id === 1) {\n          // 非工作时间数据外发\n          data[1] = 230; // 凌晨2点数据传输峰值\n        } else if (this.selectedEvent.id === 5) {\n          // 可疑通信\n          data[10] = 320; // 晚上8-10点数据传输峰值\n        }\n        option = {\n          title: {\n            text: \"数据传输量时间分布\",\n            left: \"center\"\n          },\n          tooltip: {\n            trigger: \"axis\",\n            formatter: \"{b} <br/>{a}: {c} MB\"\n          },\n          xAxis: {\n            type: \"category\",\n            data: hours\n          },\n          yAxis: {\n            type: \"value\",\n            name: \"传输量(MB)\"\n          },\n          series: [{\n            name: \"数据量\",\n            type: \"bar\",\n            data: data,\n            markPoint: {\n              data: [{\n                type: \"max\",\n                name: \"最大值\"\n              }]\n            }\n          }]\n        };\n      } else if (this.selectedEvent.type === \"账户探测\") {\n        // 登录尝试成功/失败统计\n        option = {\n          title: {\n            text: \"账户登录尝试结果\",\n            left: \"center\"\n          },\n          tooltip: {\n            trigger: \"item\",\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\"\n          },\n          legend: {\n            orient: \"vertical\",\n            left: 10,\n            data: [\"登录成功\", \"登录失败\"]\n          },\n          series: [{\n            name: \"登录结果\",\n            type: \"pie\",\n            radius: [\"50%\", \"70%\"],\n            avoidLabelOverlap: false,\n            label: {\n              show: false,\n              position: \"center\"\n            },\n            emphasis: {\n              label: {\n                show: true,\n                fontSize: \"18\",\n                fontWeight: \"bold\"\n              }\n            },\n            labelLine: {\n              show: false\n            },\n            data: [{\n              value: 3,\n              name: \"登录成功\"\n            }, {\n              value: 12,\n              name: \"登录失败\"\n            }]\n          }]\n        };\n      } else if (this.selectedEvent.type === \"异常行为\") {\n        // 一周工作时间模式\n        const days = [\"11.10\", \"11.11\", \"11.12\", \"11.13\", \"11.14\", \"11.15\", \"11.16\"];\n        option = {\n          title: {\n            text: \"近一周办公时间模式\",\n            left: \"center\"\n          },\n          tooltip: {\n            position: \"top\"\n          },\n          grid: {\n            height: \"50%\",\n            top: \"20%\"\n          },\n          xAxis: {\n            type: \"category\",\n            data: days,\n            splitArea: {\n              show: true\n            }\n          },\n          yAxis: {\n            type: \"category\",\n            data: [\"0:00-6:00\", \"6:00-12:00\", \"12:00-18:00\", \"18:00-24:00\"],\n            splitArea: {\n              show: true\n            }\n          },\n          visualMap: {\n            min: 0,\n            max: 5,\n            calculable: true,\n            orient: \"horizontal\",\n            left: \"center\",\n            bottom: \"0%\",\n            textStyle: {\n              color: \"#000\"\n            }\n          },\n          series: [{\n            name: \"工作时长(小时)\",\n            type: \"heatmap\",\n            data: [[0, 0, 3], [0, 1, 0], [0, 2, 5], [0, 3, 4], [1, 0, 4], [1, 1, 0], [1, 2, 5], [1, 3, 2], [2, 0, 3], [2, 1, 0], [2, 2, 5], [2, 3, 3], [3, 0, 2], [3, 1, 0], [3, 2, 5], [3, 3, 4], [4, 0, 5], [4, 1, 0], [4, 2, 4], [4, 3, 5], [5, 0, 4], [5, 1, 0], [5, 2, 3], [5, 3, 5], [6, 0, 0], [6, 1, 0], [6, 2, 0], [6, 3, 0]],\n            label: {\n              show: true\n            },\n            emphasis: {\n              itemStyle: {\n                shadowBlur: 10,\n                shadowColor: \"rgba(0, 0, 0, 0.5)\"\n              }\n            }\n          }]\n        };\n      } else if (this.selectedEvent.type === \"数据库异常\") {\n        // 数据库查询类型分布\n        option = {\n          title: {\n            text: \"数据库查询类型分布\",\n            left: \"center\"\n          },\n          tooltip: {\n            trigger: \"item\",\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\"\n          },\n          legend: {\n            orient: \"vertical\",\n            left: 10,\n            data: [\"产品设计表\", \"用户数据表\", \"配置表\", \"测试数据表\", \"其他表\"]\n          },\n          series: [{\n            name: \"查询占比\",\n            type: \"pie\",\n            radius: \"55%\",\n            center: [\"50%\", \"60%\"],\n            data: [{\n              value: 120,\n              name: \"产品设计表\"\n            }, {\n              value: 65,\n              name: \"用户数据表\"\n            }, {\n              value: 40,\n              name: \"配置表\"\n            }, {\n              value: 25,\n              name: \"测试数据表\"\n            }, {\n              value: 15,\n              name: \"其他表\"\n            }],\n            emphasis: {\n              itemStyle: {\n                shadowBlur: 10,\n                shadowOffsetX: 0,\n                shadowColor: \"rgba(0, 0, 0, 0.5)\"\n              }\n            }\n          }]\n        };\n      }\n      this.evidenceChart.setOption(option);\n    },\n    getEventTypeTag(type) {\n      const typeMap = {\n        数据外发: \"danger\",\n        账户探测: \"warning\",\n        异常行为: \"warning\",\n        数据库异常: \"danger\",\n        可疑通信: \"danger\"\n      };\n      return typeMap[type] || \"info\";\n    },\n    getRiskLevelTag(level) {\n      const levelMap = {\n        高: \"danger\",\n        中: \"warning\",\n        低: \"info\"\n      };\n      return levelMap[level] || \"info\";\n    }\n  }\n};","map":{"version":3,"names":["name","data","threatRelationChart","evidenceChart","selectedEvent","threatEvents","id","type","date","time","user","description","detailDescription","level","mounted","initThreatRelationChart","window","addEventListener","handleResize","beforeDestroy","removeEventListener","methods","resize","$echarts","init","document","getElementById","option","title","text","subtext","left","tooltip","formatter","params","dataType","legend","top","right","animationDurationUpdate","animationEasingUpdate","series","layout","force","repulsion","edgeLength","gravity","layoutAnimation","roam","draggable","focusNodeAdjacency","label","show","position","fontSize","fontWeight","category","symbolSize","itemStyle","color","links","source","target","lineStyle","width","curveness","categories","opacity","emphasis","focus","shadowBlur","shadowColor","setOption","on","event","find","item","handleEventSelect","row","$nextTick","initEvidenceChart","hours","trigger","xAxis","yAxis","markPoint","orient","radius","avoidLabelOverlap","labelLine","value","days","grid","height","splitArea","visualMap","min","max","calculable","bottom","textStyle","center","shadowOffsetX","getEventTypeTag","typeMap","数据外发","账户探测","异常行为","数据库异常","可疑通信","getRiskLevelTag","levelMap","高","中","低"],"sources":["src/views/Threat.vue"],"sourcesContent":["<template>\r\n  <div class=\"threat\">\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <el-card class=\"box-card\">\r\n          <div slot=\"header\" class=\"clearfix\">\r\n            <span>威胁情报分析</span>\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"检测并分析可能存在的内部威胁事件，探究事件间的关联性\"\r\n              placement=\"top\"\r\n            >\r\n              <i class=\"el-icon-question\" style=\"margin-left: 10px\"></i>\r\n            </el-tooltip>\r\n          </div>\r\n          <p>\r\n            通过对多维数据的关联分析，我们发现了多起可疑行为并关联成威胁情报，这些情报可能表明有内部人员试图获取或泄露公司核心产品信息。\r\n          </p>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <el-row :gutter=\"20\" style=\"margin-top: 20px\">\r\n      <el-col :span=\"16\">\r\n        <el-card class=\"box-card\">\r\n          <div slot=\"header\" class=\"clearfix\">\r\n            <span>威胁事件关联图</span>\r\n          </div>\r\n          <div\r\n            id=\"threatRelationChart\"\r\n            style=\"width: 100%; height: 600px\"\r\n          ></div>\r\n        </el-card>\r\n      </el-col>\r\n      <el-col :span=\"8\">\r\n        <el-card class=\"box-card\">\r\n          <div slot=\"header\" class=\"clearfix\">\r\n            <span>威胁事件列表</span>\r\n          </div>\r\n          <el-table\r\n            :data=\"threatEvents\"\r\n            style=\"width: 100%\"\r\n            max-height=\"550\"\r\n            @row-click=\"handleEventSelect\"\r\n          >\r\n            <el-table-column\r\n              prop=\"id\"\r\n              label=\"编号\"\r\n              width=\"60\"\r\n            ></el-table-column>\r\n            <el-table-column prop=\"type\" label=\"类型\" width=\"100\">\r\n              <template slot-scope=\"scope\">\r\n                <el-tag :type=\"getEventTypeTag(scope.row.type)\">{{\r\n                  scope.row.type\r\n                }}</el-tag>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              prop=\"date\"\r\n              label=\"日期\"\r\n              width=\"100\"\r\n            ></el-table-column>\r\n            <el-table-column prop=\"description\" label=\"描述\"></el-table-column>\r\n            <el-table-column prop=\"level\" label=\"风险等级\" width=\"80\">\r\n              <template slot-scope=\"scope\">\r\n                <el-tag :type=\"getRiskLevelTag(scope.row.level)\">{{\r\n                  scope.row.level\r\n                }}</el-tag>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <el-row style=\"margin-top: 20px\">\r\n      <el-col :span=\"24\">\r\n        <el-card class=\"box-card\" v-if=\"selectedEvent\">\r\n          <div slot=\"header\" class=\"clearfix\">\r\n            <span>事件详情: {{ selectedEvent.description }}</span>\r\n          </div>\r\n          <el-row :gutter=\"20\">\r\n            <el-col :span=\"12\">\r\n              <h4>事件信息</h4>\r\n              <el-descriptions :column=\"1\" border>\r\n                <el-descriptions-item label=\"事件ID\">{{\r\n                  selectedEvent.id\r\n                }}</el-descriptions-item>\r\n                <el-descriptions-item label=\"类型\">{{\r\n                  selectedEvent.type\r\n                }}</el-descriptions-item>\r\n                <el-descriptions-item label=\"日期\">{{\r\n                  selectedEvent.date\r\n                }}</el-descriptions-item>\r\n                <el-descriptions-item label=\"时间\">{{\r\n                  selectedEvent.time\r\n                }}</el-descriptions-item>\r\n                <el-descriptions-item label=\"相关用户\">{{\r\n                  selectedEvent.user\r\n                }}</el-descriptions-item>\r\n                <el-descriptions-item label=\"风险等级\">\r\n                  <el-tag :type=\"getRiskLevelTag(selectedEvent.level)\">{{\r\n                    selectedEvent.level\r\n                  }}</el-tag>\r\n                </el-descriptions-item>\r\n                <el-descriptions-item label=\"详细描述\">{{\r\n                  selectedEvent.detailDescription\r\n                }}</el-descriptions-item>\r\n              </el-descriptions>\r\n            </el-col>\r\n            <el-col :span=\"12\">\r\n              <h4>相关证据</h4>\r\n              <div id=\"evidenceChart\" style=\"width: 100%; height: 300px\"></div>\r\n            </el-col>\r\n          </el-row>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <el-row style=\"margin-top: 20px\">\r\n      <el-col :span=\"24\">\r\n        <el-card class=\"box-card\">\r\n          <div slot=\"header\" class=\"clearfix\">\r\n            <span>威胁情报综合分析</span>\r\n          </div>\r\n          <div class=\"analysis-content\">\r\n            <h3>主要威胁情报发现</h3>\r\n            <p>\r\n              通过对公司内部各种日志数据的综合分析，我们发现了以下几个主要的威胁情报：\r\n            </p>\r\n\r\n            <h4>1. 大量敏感文件访问与数据外发</h4>\r\n            <p>\r\n              研发2部的员工ID-1103在非常规工作时间（凌晨2:00-4:00）登录公司服务器，访问并下载了大量与新产品相关的文件，同时向外部邮箱发送了多封带有大附件的邮件。\r\n            </p>\r\n\r\n            <h4>2. 异常登录行为</h4>\r\n            <p>\r\n              员工ID-1152在11月10日至11月15日期间多次尝试登录其他研发人员的账户，成功率较低但存在成功案例，显示出明显的账户探测行为。\r\n            </p>\r\n\r\n            <h4>3. 反常规上班模式</h4>\r\n            <p>\r\n              员工ID-1388在11月5日至11月20日期间，连续多天出现深夜在办公室活动的记录，但第二天通常迟到或缺勤，与其历史工作模式存在显著差异。\r\n            </p>\r\n\r\n            <h4>4. 数据库异常查询</h4>\r\n            <p>\r\n              研发3部的员工ID-1307在11月8日至11月12日期间，对公司核心产品数据库进行了大量非常规查询，涉及表数量远超其工作所需。\r\n            </p>\r\n\r\n            <h4>5. 可疑外部通信</h4>\r\n            <p>\r\n              员工ID-1204在11月18日至11月25日期间，其工作站与多个未知IP地址建立了加密连接，流量模式表明可能存在数据外传。\r\n            </p>\r\n\r\n            <h3>威胁关联分析</h3>\r\n            <p>\r\n              这些异常事件并非相互独立，通过对时间、网络行为和邮件往来的分析，我们发现：\r\n            </p>\r\n            <ul>\r\n              <li>\r\n                员工ID-1103和员工ID-1204有频繁的邮件往来，且邮件内容多涉及新产品的技术细节\r\n              </li>\r\n              <li>\r\n                员工ID-1152与员工ID-1388在同一网段活动，且活动时间有明显的交错模式\r\n              </li>\r\n              <li>\r\n                在员工ID-1307进行异常数据库查询的同一时间段，员工ID-1103的外发邮件数量明显增加\r\n              </li>\r\n              <li>\r\n                所有涉事员工近期都曾访问过相同的外部技术论坛和几个特定IP地址\r\n              </li>\r\n            </ul>\r\n\r\n            <h3>分析方法说明</h3>\r\n            <p>本系统采用多维数据关联分析方法发现这些威胁情报：</p>\r\n            <ol>\r\n              <li>\r\n                通过员工打卡记录与登录时间的交叉分析，发现工作时间与系统活动不匹配的异常\r\n              </li>\r\n              <li>\r\n                使用聚类算法对邮件往来建立关系网络，识别出不寻常的沟通模式\r\n              </li>\r\n              <li>对网络流量进行时序分析，发现工作时间之外的异常流量峰值</li>\r\n              <li>分析登录日志中的失败模式，识别可能的账户探测行为</li>\r\n              <li>\r\n                利用关联规则挖掘算法，发现不同异常事件之间的时间和行为关联\r\n              </li>\r\n            </ol>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Threat\",\r\n  data() {\r\n    return {\r\n      threatRelationChart: null,\r\n      evidenceChart: null,\r\n      selectedEvent: null,\r\n      threatEvents: [\r\n        {\r\n          id: 1,\r\n          type: \"数据外发\",\r\n          date: \"2017-11-12\",\r\n          time: \"02:35:18\",\r\n          user: \"1103\",\r\n          description: \"非工作时间大量数据传输\",\r\n          detailDescription:\r\n            \"员工1103在凌晨2:35分登录服务器，下载大量产品设计文件并发送至外部邮箱。期间共传输了约230MB数据，包含多个产品核心模块的设计文档和源代码片段。\",\r\n          level: \"高\",\r\n        },\r\n        {\r\n          id: 2,\r\n          type: \"账户探测\",\r\n          date: \"2017-11-13\",\r\n          time: \"20:14:56\",\r\n          user: \"1152\",\r\n          description: \"多次尝试登录他人账户\",\r\n          detailDescription:\r\n            \"员工1152在11月13日晚间尝试登录15个不同研发人员的账户，成功登录3个，访问了代码仓库和设计文档。使用的IP地址在公司网络范围内但非其常用工作站。\",\r\n          level: \"中\",\r\n        },\r\n        {\r\n          id: 3,\r\n          type: \"异常行为\",\r\n          date: \"2017-11-15\",\r\n          time: \"23:45:07\",\r\n          user: \"1388\",\r\n          description: \"深夜办公异常活动\",\r\n          detailDescription:\r\n            \"员工1388在11月15日23:45至次日凌晨3:20期间，在办公室进行工作，访问了大量与其工作职责无关的系统和文件。次日请假未到岗。这是连续第5天出现类似模式。\",\r\n          level: \"中\",\r\n        },\r\n        {\r\n          id: 4,\r\n          type: \"数据库异常\",\r\n          date: \"2017-11-10\",\r\n          time: \"15:23:41\",\r\n          user: \"1307\",\r\n          description: \"大量非常规数据库查询\",\r\n          detailDescription:\r\n            \"员工1307在11月10日执行了超过200次数据库查询，涉及产品核心数据表的多个敏感字段。查询模式显示系统性的数据收集行为，远超正常工作所需。\",\r\n          level: \"高\",\r\n        },\r\n        {\r\n          id: 5,\r\n          type: \"可疑通信\",\r\n          date: \"2017-11-22\",\r\n          time: \"19:08:33\",\r\n          user: \"1204\",\r\n          description: \"与未知IP地址加密通信\",\r\n          detailDescription:\r\n            \"员工1204的工作站在11月22日与5个未在公司白名单内的IP地址建立加密连接，总计传输数据约320MB。流量特征与数据泄露的典型模式高度匹配。\",\r\n          level: \"高\",\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  mounted() {\r\n    this.initThreatRelationChart();\r\n    window.addEventListener(\"resize\", this.handleResize);\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener(\"resize\", this.handleResize);\r\n  },\r\n  methods: {\r\n    handleResize() {\r\n      this.threatRelationChart && this.threatRelationChart.resize();\r\n      this.evidenceChart && this.evidenceChart.resize();\r\n    },\r\n    initThreatRelationChart() {\r\n      this.threatRelationChart = this.$echarts.init(\r\n        document.getElementById(\"threatRelationChart\")\r\n      );\r\n\r\n      const option = {\r\n        title: {\r\n          text: \"威胁事件关联图\",\r\n          subtext: \"基于时间、人员和行为关联分析\",\r\n          left: \"center\",\r\n        },\r\n        tooltip: {\r\n          formatter: function (params) {\r\n            if (params.dataType === \"edge\") {\r\n              return params.data.name;\r\n            }\r\n            return (\r\n              params.data.name +\r\n              \"<br/>ID: \" +\r\n              params.data.id +\r\n              \"<br/>日期: \" +\r\n              params.data.date\r\n            );\r\n          },\r\n        },\r\n        legend: [\r\n          {\r\n            data: [\r\n              \"数据外发\",\r\n              \"账户探测\",\r\n              \"异常行为\",\r\n              \"数据库异常\",\r\n              \"可疑通信\",\r\n              \"涉事员工\",\r\n            ],\r\n            top: 30,\r\n            right: 10,\r\n          },\r\n        ],\r\n        animationDurationUpdate: 1500,\r\n        animationEasingUpdate: \"quinticInOut\",\r\n        series: [\r\n          {\r\n            name: \"威胁关联\",\r\n            type: \"graph\",\r\n            layout: \"force\",\r\n            force: {\r\n              repulsion: 300,\r\n              edgeLength: 120,\r\n              gravity: 0.1,\r\n              layoutAnimation: true,\r\n            },\r\n            roam: true,\r\n            draggable: true,\r\n            focusNodeAdjacency: true,\r\n            label: {\r\n              show: true,\r\n              position: \"right\",\r\n              formatter: \"{b}\",\r\n              fontSize: 12,\r\n              fontWeight: \"bold\",\r\n            },\r\n            data: [\r\n              {\r\n                name: \"非工作时间数据外发\",\r\n                category: 0,\r\n                id: 1,\r\n                date: \"2017-11-12\",\r\n                symbolSize: 50,\r\n                itemStyle: { color: \"#F56C6C\" },\r\n              },\r\n              {\r\n                name: \"多次尝试登录他人账户\",\r\n                category: 1,\r\n                id: 2,\r\n                date: \"2017-11-13\",\r\n                symbolSize: 45,\r\n                itemStyle: { color: \"#E6A23C\" },\r\n              },\r\n              {\r\n                name: \"深夜办公异常活动\",\r\n                category: 2,\r\n                id: 3,\r\n                date: \"2017-11-15\",\r\n                symbolSize: 45,\r\n                itemStyle: { color: \"#E6A23C\" },\r\n              },\r\n              {\r\n                name: \"大量非常规数据库查询\",\r\n                category: 3,\r\n                id: 4,\r\n                date: \"2017-11-10\",\r\n                symbolSize: 50,\r\n                itemStyle: { color: \"#F56C6C\" },\r\n              },\r\n              {\r\n                name: \"与未知IP加密通信\",\r\n                category: 4,\r\n                id: 5,\r\n                date: \"2017-11-22\",\r\n                symbolSize: 50,\r\n                itemStyle: { color: \"#F56C6C\" },\r\n              },\r\n              {\r\n                name: \"员工1103\",\r\n                category: 5,\r\n                symbolSize: 38,\r\n                itemStyle: { color: \"#409EFF\" },\r\n              },\r\n              {\r\n                name: \"员工1152\",\r\n                category: 5,\r\n                symbolSize: 38,\r\n                itemStyle: { color: \"#409EFF\" },\r\n              },\r\n              {\r\n                name: \"员工1388\",\r\n                category: 5,\r\n                symbolSize: 38,\r\n                itemStyle: { color: \"#409EFF\" },\r\n              },\r\n              {\r\n                name: \"员工1307\",\r\n                category: 5,\r\n                symbolSize: 38,\r\n                itemStyle: { color: \"#409EFF\" },\r\n              },\r\n              {\r\n                name: \"员工1204\",\r\n                category: 5,\r\n                symbolSize: 38,\r\n                itemStyle: { color: \"#409EFF\" },\r\n              },\r\n              {\r\n                name: \"外部邮箱\",\r\n                category: 5,\r\n                symbolSize: 30,\r\n                itemStyle: { color: \"#67C23A\" },\r\n              },\r\n              {\r\n                name: \"未知IP地址\",\r\n                category: 5,\r\n                symbolSize: 30,\r\n                itemStyle: { color: \"#67C23A\" },\r\n              },\r\n              {\r\n                name: \"产品代码仓库\",\r\n                category: 5,\r\n                symbolSize: 30,\r\n                itemStyle: { color: \"#67C23A\" },\r\n              },\r\n              {\r\n                name: \"产品数据库\",\r\n                category: 5,\r\n                symbolSize: 30,\r\n                itemStyle: { color: \"#67C23A\" },\r\n              },\r\n            ],\r\n            links: [\r\n              {\r\n                source: \"员工1103\",\r\n                target: \"非工作时间数据外发\",\r\n                name: \"执行者\",\r\n                lineStyle: {\r\n                  width: 3,\r\n                  color: \"#F56C6C\",\r\n                },\r\n              },\r\n              {\r\n                source: \"员工1152\",\r\n                target: \"多次尝试登录他人账户\",\r\n                name: \"执行者\",\r\n                lineStyle: {\r\n                  width: 3,\r\n                  color: \"#E6A23C\",\r\n                },\r\n              },\r\n              {\r\n                source: \"员工1388\",\r\n                target: \"深夜办公异常活动\",\r\n                name: \"执行者\",\r\n                lineStyle: {\r\n                  width: 3,\r\n                  color: \"#E6A23C\",\r\n                },\r\n              },\r\n              {\r\n                source: \"员工1307\",\r\n                target: \"大量非常规数据库查询\",\r\n                name: \"执行者\",\r\n                lineStyle: {\r\n                  width: 3,\r\n                  color: \"#F56C6C\",\r\n                },\r\n              },\r\n              {\r\n                source: \"员工1204\",\r\n                target: \"与未知IP加密通信\",\r\n                name: \"执行者\",\r\n                lineStyle: {\r\n                  width: 3,\r\n                  color: \"#F56C6C\",\r\n                },\r\n              },\r\n              {\r\n                source: \"非工作时间数据外发\",\r\n                target: \"外部邮箱\",\r\n                name: \"数据传输\",\r\n                lineStyle: {\r\n                  width: 3,\r\n                },\r\n              },\r\n              {\r\n                source: \"非工作时间数据外发\",\r\n                target: \"产品代码仓库\",\r\n                name: \"数据来源\",\r\n                lineStyle: {\r\n                  width: 2,\r\n                },\r\n              },\r\n              {\r\n                source: \"多次尝试登录他人账户\",\r\n                target: \"产品代码仓库\",\r\n                name: \"访问目标\",\r\n                lineStyle: {\r\n                  width: 2,\r\n                },\r\n              },\r\n              {\r\n                source: \"大量非常规数据库查询\",\r\n                target: \"产品数据库\",\r\n                name: \"查询目标\",\r\n                lineStyle: {\r\n                  width: 3,\r\n                },\r\n              },\r\n              {\r\n                source: \"与未知IP加密通信\",\r\n                target: \"未知IP地址\",\r\n                name: \"通信目标\",\r\n                lineStyle: {\r\n                  width: 3,\r\n                },\r\n              },\r\n              {\r\n                source: \"员工1103\",\r\n                target: \"员工1204\",\r\n                name: \"频繁邮件往来\",\r\n                lineStyle: {\r\n                  type: \"dashed\",\r\n                  width: 2,\r\n                  curveness: 0.2,\r\n                },\r\n              },\r\n              {\r\n                source: \"员工1152\",\r\n                target: \"员工1388\",\r\n                name: \"同时间段活动\",\r\n                lineStyle: {\r\n                  type: \"dashed\",\r\n                  width: 2,\r\n                  curveness: 0.2,\r\n                },\r\n              },\r\n              {\r\n                source: \"员工1307\",\r\n                target: \"员工1103\",\r\n                name: \"活动时间关联\",\r\n                lineStyle: {\r\n                  type: \"dashed\",\r\n                  width: 2,\r\n                  curveness: 0.2,\r\n                },\r\n              },\r\n              {\r\n                source: \"大量非常规数据库查询\",\r\n                target: \"非工作时间数据外发\",\r\n                name: \"时间顺序关联\",\r\n                lineStyle: {\r\n                  type: \"dashed\",\r\n                  width: 2,\r\n                  curveness: 0.2,\r\n                },\r\n              },\r\n              {\r\n                source: \"多次尝试登录他人账户\",\r\n                target: \"深夜办公异常活动\",\r\n                name: \"时间顺序关联\",\r\n                lineStyle: {\r\n                  type: \"dashed\",\r\n                  width: 2,\r\n                  curveness: 0.2,\r\n                },\r\n              },\r\n              {\r\n                source: \"与未知IP加密通信\",\r\n                target: \"外部邮箱\",\r\n                name: \"可能的同一接收方\",\r\n                lineStyle: {\r\n                  type: \"dashed\",\r\n                  width: 2,\r\n                  curveness: 0.2,\r\n                },\r\n              },\r\n            ],\r\n            categories: [\r\n              { name: \"数据外发\" },\r\n              { name: \"账户探测\" },\r\n              { name: \"异常行为\" },\r\n              { name: \"数据库异常\" },\r\n              { name: \"可疑通信\" },\r\n              { name: \"涉事员工\" },\r\n            ],\r\n            lineStyle: {\r\n              opacity: 0.9,\r\n              width: 2,\r\n              curveness: 0,\r\n            },\r\n            emphasis: {\r\n              focus: \"adjacency\",\r\n              lineStyle: {\r\n                width: 6,\r\n              },\r\n              itemStyle: {\r\n                shadowBlur: 10,\r\n                shadowColor: \"rgba(0,0,0,0.5)\",\r\n              },\r\n            },\r\n          },\r\n        ],\r\n      };\r\n\r\n      this.threatRelationChart.setOption(option);\r\n\r\n      // 点击事件处理\r\n      this.threatRelationChart.on(\"click\", (params) => {\r\n        if (params.dataType === \"node\" && params.data.id) {\r\n          // 查找并选择对应的威胁事件\r\n          const event = this.threatEvents.find(\r\n            (item) => item.id === params.data.id\r\n          );\r\n          if (event) {\r\n            this.handleEventSelect(event);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    handleEventSelect(row) {\r\n      this.selectedEvent = row;\r\n      this.$nextTick(() => {\r\n        this.initEvidenceChart();\r\n      });\r\n    },\r\n    initEvidenceChart() {\r\n      if (!this.selectedEvent) return;\r\n\r\n      this.evidenceChart = this.$echarts.init(\r\n        document.getElementById(\"evidenceChart\")\r\n      );\r\n\r\n      // 根据不同事件类型显示不同的证据图表\r\n      let option = {};\r\n\r\n      if (\r\n        this.selectedEvent.type === \"数据外发\" ||\r\n        this.selectedEvent.type === \"可疑通信\"\r\n      ) {\r\n        // 数据传输时间线\r\n        const hours = [\r\n          \"00:00\",\r\n          \"02:00\",\r\n          \"04:00\",\r\n          \"06:00\",\r\n          \"08:00\",\r\n          \"10:00\",\r\n          \"12:00\",\r\n          \"14:00\",\r\n          \"16:00\",\r\n          \"18:00\",\r\n          \"20:00\",\r\n          \"22:00\",\r\n          \"24:00\",\r\n        ];\r\n        const data = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n\r\n        // 根据事件类型设置数据\r\n        if (this.selectedEvent.id === 1) {\r\n          // 非工作时间数据外发\r\n          data[1] = 230; // 凌晨2点数据传输峰值\r\n        } else if (this.selectedEvent.id === 5) {\r\n          // 可疑通信\r\n          data[10] = 320; // 晚上8-10点数据传输峰值\r\n        }\r\n\r\n        option = {\r\n          title: {\r\n            text: \"数据传输量时间分布\",\r\n            left: \"center\",\r\n          },\r\n          tooltip: {\r\n            trigger: \"axis\",\r\n            formatter: \"{b} <br/>{a}: {c} MB\",\r\n          },\r\n          xAxis: {\r\n            type: \"category\",\r\n            data: hours,\r\n          },\r\n          yAxis: {\r\n            type: \"value\",\r\n            name: \"传输量(MB)\",\r\n          },\r\n          series: [\r\n            {\r\n              name: \"数据量\",\r\n              type: \"bar\",\r\n              data: data,\r\n              markPoint: {\r\n                data: [{ type: \"max\", name: \"最大值\" }],\r\n              },\r\n            },\r\n          ],\r\n        };\r\n      } else if (this.selectedEvent.type === \"账户探测\") {\r\n        // 登录尝试成功/失败统计\r\n        option = {\r\n          title: {\r\n            text: \"账户登录尝试结果\",\r\n            left: \"center\",\r\n          },\r\n          tooltip: {\r\n            trigger: \"item\",\r\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\",\r\n          },\r\n          legend: {\r\n            orient: \"vertical\",\r\n            left: 10,\r\n            data: [\"登录成功\", \"登录失败\"],\r\n          },\r\n          series: [\r\n            {\r\n              name: \"登录结果\",\r\n              type: \"pie\",\r\n              radius: [\"50%\", \"70%\"],\r\n              avoidLabelOverlap: false,\r\n              label: {\r\n                show: false,\r\n                position: \"center\",\r\n              },\r\n              emphasis: {\r\n                label: {\r\n                  show: true,\r\n                  fontSize: \"18\",\r\n                  fontWeight: \"bold\",\r\n                },\r\n              },\r\n              labelLine: {\r\n                show: false,\r\n              },\r\n              data: [\r\n                { value: 3, name: \"登录成功\" },\r\n                { value: 12, name: \"登录失败\" },\r\n              ],\r\n            },\r\n          ],\r\n        };\r\n      } else if (this.selectedEvent.type === \"异常行为\") {\r\n        // 一周工作时间模式\r\n        const days = [\r\n          \"11.10\",\r\n          \"11.11\",\r\n          \"11.12\",\r\n          \"11.13\",\r\n          \"11.14\",\r\n          \"11.15\",\r\n          \"11.16\",\r\n        ];\r\n\r\n        option = {\r\n          title: {\r\n            text: \"近一周办公时间模式\",\r\n            left: \"center\",\r\n          },\r\n          tooltip: {\r\n            position: \"top\",\r\n          },\r\n          grid: {\r\n            height: \"50%\",\r\n            top: \"20%\",\r\n          },\r\n          xAxis: {\r\n            type: \"category\",\r\n            data: days,\r\n            splitArea: {\r\n              show: true,\r\n            },\r\n          },\r\n          yAxis: {\r\n            type: \"category\",\r\n            data: [\"0:00-6:00\", \"6:00-12:00\", \"12:00-18:00\", \"18:00-24:00\"],\r\n            splitArea: {\r\n              show: true,\r\n            },\r\n          },\r\n          visualMap: {\r\n            min: 0,\r\n            max: 5,\r\n            calculable: true,\r\n            orient: \"horizontal\",\r\n            left: \"center\",\r\n            bottom: \"0%\",\r\n            textStyle: {\r\n              color: \"#000\",\r\n            },\r\n          },\r\n          series: [\r\n            {\r\n              name: \"工作时长(小时)\",\r\n              type: \"heatmap\",\r\n              data: [\r\n                [0, 0, 3],\r\n                [0, 1, 0],\r\n                [0, 2, 5],\r\n                [0, 3, 4],\r\n                [1, 0, 4],\r\n                [1, 1, 0],\r\n                [1, 2, 5],\r\n                [1, 3, 2],\r\n                [2, 0, 3],\r\n                [2, 1, 0],\r\n                [2, 2, 5],\r\n                [2, 3, 3],\r\n                [3, 0, 2],\r\n                [3, 1, 0],\r\n                [3, 2, 5],\r\n                [3, 3, 4],\r\n                [4, 0, 5],\r\n                [4, 1, 0],\r\n                [4, 2, 4],\r\n                [4, 3, 5],\r\n                [5, 0, 4],\r\n                [5, 1, 0],\r\n                [5, 2, 3],\r\n                [5, 3, 5],\r\n                [6, 0, 0],\r\n                [6, 1, 0],\r\n                [6, 2, 0],\r\n                [6, 3, 0],\r\n              ],\r\n              label: {\r\n                show: true,\r\n              },\r\n              emphasis: {\r\n                itemStyle: {\r\n                  shadowBlur: 10,\r\n                  shadowColor: \"rgba(0, 0, 0, 0.5)\",\r\n                },\r\n              },\r\n            },\r\n          ],\r\n        };\r\n      } else if (this.selectedEvent.type === \"数据库异常\") {\r\n        // 数据库查询类型分布\r\n        option = {\r\n          title: {\r\n            text: \"数据库查询类型分布\",\r\n            left: \"center\",\r\n          },\r\n          tooltip: {\r\n            trigger: \"item\",\r\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\",\r\n          },\r\n          legend: {\r\n            orient: \"vertical\",\r\n            left: 10,\r\n            data: [\r\n              \"产品设计表\",\r\n              \"用户数据表\",\r\n              \"配置表\",\r\n              \"测试数据表\",\r\n              \"其他表\",\r\n            ],\r\n          },\r\n          series: [\r\n            {\r\n              name: \"查询占比\",\r\n              type: \"pie\",\r\n              radius: \"55%\",\r\n              center: [\"50%\", \"60%\"],\r\n              data: [\r\n                { value: 120, name: \"产品设计表\" },\r\n                { value: 65, name: \"用户数据表\" },\r\n                { value: 40, name: \"配置表\" },\r\n                { value: 25, name: \"测试数据表\" },\r\n                { value: 15, name: \"其他表\" },\r\n              ],\r\n              emphasis: {\r\n                itemStyle: {\r\n                  shadowBlur: 10,\r\n                  shadowOffsetX: 0,\r\n                  shadowColor: \"rgba(0, 0, 0, 0.5)\",\r\n                },\r\n              },\r\n            },\r\n          ],\r\n        };\r\n      }\r\n\r\n      this.evidenceChart.setOption(option);\r\n    },\r\n    getEventTypeTag(type) {\r\n      const typeMap = {\r\n        数据外发: \"danger\",\r\n        账户探测: \"warning\",\r\n        异常行为: \"warning\",\r\n        数据库异常: \"danger\",\r\n        可疑通信: \"danger\",\r\n      };\r\n      return typeMap[type] || \"info\";\r\n    },\r\n    getRiskLevelTag(level) {\r\n      const levelMap = {\r\n        高: \"danger\",\r\n        中: \"warning\",\r\n        低: \"info\",\r\n      };\r\n      return levelMap[level] || \"info\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.box-card {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.analysis-content {\r\n  line-height: 1.6;\r\n  text-align: justify;\r\n}\r\n\r\n.analysis-content h3 {\r\n  margin-top: 20px;\r\n  color: #303133;\r\n  border-bottom: 1px solid #ebeef5;\r\n  padding-bottom: 8px;\r\n}\r\n\r\n.analysis-content h4 {\r\n  margin-top: 15px;\r\n  color: #409eff;\r\n}\r\n\r\n.analysis-content ul,\r\n.analysis-content ol {\r\n  padding-left: 20px;\r\n  margin: 10px 0;\r\n}\r\n\r\n.analysis-content li {\r\n  margin-bottom: 5px;\r\n}\r\n</style>\r\n"],"mappings":"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AA;YAAA;UACA,GACA;YACA3D,IAAA;YACAwD,QAAA;YACAC,UAAA;YACAC,SAAA;cAAAC,KAAA;YAAA;UACA,GACA;YACA3D,IAAA;YACAwD,QAAA;YACAC,UAAA;YACAC,SAAA;cAAAC,KAAA;YAAA;UACA,GACA;YACA3D,IAAA;YACAwD,QAAA;YACAC,UAAA;YACAC,SAAA;cAAAC,KAAA;YAAA;UACA,GACA;YACA3D,IAAA;YACAwD,QAAA;YACAC,UAAA;YACAC,SAAA;cAAAC,KAAA;YAAA;UACA,EACA;UACAC,KAAA,GACA;YACAC,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;cACAL,KAAA;YACA;UACA,GACA;YACAE,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;cACAL,KAAA;YACA;UACA,GACA;YACAE,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;cACAL,KAAA;YACA;UACA,GACA;YACAE,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;cACAL,KAAA;YACA;UACA,GACA;YACAE,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;cACAL,KAAA;YACA;UACA,GACA;YACAE,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;YACA;UACA,GACA;YACAH,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;YACA;UACA,GACA;YACAH,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;YACA;UACA,GACA;YACAH,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;YACA;UACA,GACA;YACAH,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAC,KAAA;YACA;UACA,GACA;YACAH,MAAA;YACAC,MAAA;YACA9D,IAAA;YACA+D,SAAA;cACAxD,IAAA;cACAyD,KAAA;cACAC,SAAA;YACA;UACA,GACA;YACAJ,M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,IACA,SACA,SACA,SACA,SACA,SACA,SACA,QACA;QAEAhE,MAAA;UACAC,KAAA;YACAC,IAAA;YACAE,IAAA;UACA;UACAC,OAAA;YACAqB,QAAA;UACA;UACAuC,IAAA;YACAC,MAAA;YACAxD,GAAA;UACA;UACA8C,KAAA;YACA5E,IAAA;YACAN,IAAA,EAAA0F,IAAA;YACAG,SAAA;cACA1C,IAAA;YACA;UACA;UACAgC,KAAA;YACA7E,IAAA;YACAN,IAAA;YACA6F,SAAA;cACA1C,IAAA;YACA;UACA;UACA2C,SAAA;YACAC,GAAA;YACAC,GAAA;YACAC,UAAA;YACAZ,MAAA;YACAvD,IAAA;YACAoE,MAAA;YACAC,SAAA;cACAzC,KAAA;YACA;UACA;UACAlB,MAAA,GACA;YACAzC,IAAA;YACAO,IAAA;YACAN,IAAA,GACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA;YACAkD,KAAA;cACAC,IAAA;YACA;YACAgB,QAAA;cACAV,SAAA;gBACAY,UAAA;gBACAC,WAAA;cACA;YACA;UACA;QAEA;MACA,gBAAAnE,aAAA,CAAAG,IAAA;QACA;QACAoB,MAAA;UACAC,KAAA;YACAC,IAAA;YACAE,IAAA;UACA;UACAC,OAAA;YACAkD,OAAA;YACAjD,SAAA;UACA;UACAG,MAAA;YACAkD,MAAA;YACAvD,IAAA;YACA9B,IAAA,GACA,SACA,SACA,OACA,SACA;UAEA;UACAwC,MAAA,GACA;YACAzC,IAAA;YACAO,IAAA;YACAgF,MAAA;YACAc,MAAA;YACApG,IAAA,GACA;cAAAyF,KAAA;cAAA1F,IAAA;YAAA,GACA;cAAA0F,KAAA;cAAA1F,IAAA;YAAA,GACA;cAAA0F,KAAA;cAAA1F,IAAA;YAAA,GACA;cAAA0F,KAAA;cAAA1F,IAAA;YAAA,GACA;cAAA0F,KAAA;cAAA1F,IAAA;YAAA,EACA;YACAoE,QAAA;cACAV,SAAA;gBACAY,UAAA;gBACAgC,aAAA;gBACA/B,WAAA;cACA;YACA;UACA;QAEA;MACA;MAEA,KAAApE,aAAA,CAAAqE,SAAA,CAAA7C,MAAA;IACA;IACA4E,gBAAAhG,IAAA;MACA,MAAAiG,OAAA;QACAC,IAAA;QACAC,IAAA;QACAC,IAAA;QACAC,KAAA;QACAC,IAAA;MACA;MACA,OAAAL,OAAA,CAAAjG,IAAA;IACA;IACAuG,gBAAAjG,KAAA;MACA,MAAAkG,QAAA;QACAC,CAAA;QACAC,CAAA;QACAC,CAAA;MACA;MACA,OAAAH,QAAA,CAAAlG,KAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}